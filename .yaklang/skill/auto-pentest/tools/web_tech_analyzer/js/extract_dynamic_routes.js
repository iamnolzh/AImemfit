(() => {
  const out = new Set();
  const pushPath = p => { if (typeof p === 'string' && p.startsWith('/')) out.add(p); };

  // 动态路由检测 - 支持多种框架和配置方式
  try { (window.$cloudwise && window.$cloudwise.routes || []).forEach(r => r && pushPath(r.path)); } catch (e) {}
  try { (window.router && window.router.options && window.router.options.routes || []).forEach(r => r && pushPath(r.path)); } catch (e) {}
  try { (window.__ROUTES__ || []).forEach(r => r && pushPath(r.path)); } catch (e) {}
  try { (window.__reactRoutes || []).forEach(r => r && pushPath(r.path)); } catch (e) {}

  // Angular路由检测
  try {
    if (window.ng && window.ng.router && window.ng.router.config) {
      window.ng.router.config.forEach(r => r && pushPath(r.path));
    }
  } catch (e) {}

  // 从history API中提取路由
  try {
    if (window.history && window.history.state) {
      // 某些应用会在history state中存储路由信息
      const state = window.history.state;
      if (state && typeof state === 'object') {
        if (state.path) pushPath(state.path);
        if (state.route && state.route.path) pushPath(state.route.path);
      }
    }
  } catch (e) {}

  Array.from(document.querySelectorAll('a[href]')).forEach(a => {
    const h = a.getAttribute('href');
    if (h && h.startsWith('/')) out.add(h.split('#')[0]);
  });

  return JSON.stringify({ routes: Array.from(out) });
})();
