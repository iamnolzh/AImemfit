(() => {
  const out = new Set();
  const pushPath = p => { if (typeof p === 'string' && p.startsWith('/')) out.add(p); };

  // Vue Router 检测 - 多种可能的位置
  try {
    const routes = window.router && window.router.options && window.router.options.routes;
    if (Array.isArray(routes)) routes.forEach(r => r && pushPath(r.path));
  } catch (e) {}

  // 全局配置对象中的路由
  try {
    const routes = window.$cloudwise && window.$cloudwise.routes;
    if (Array.isArray(routes)) routes.forEach(r => r && pushPath(r.path));
  } catch (e) {}

  // Vue 实例上的路由
  try {
    if (window.Vue && window.Vue.prototype) {
      const router = window.Vue.prototype.$router;
      if (router && router.options && router.options.routes) {
        router.options.routes.forEach(r => r && pushPath(r.path));
      }
    }
  } catch (e) {}

  // 从DOM中提取可能的Vue路由链接
  try {
    document.querySelectorAll('a[href^="/"], [vue-router-link]').forEach(el => {
      const href = el.getAttribute('href') || el.getAttribute('to');
      if (href && href.startsWith('/')) {
        out.add(href.split('#')[0].split('?')[0]);
      }
    });
  } catch (e) {}

  return JSON.stringify({ routes: Array.from(out) });
})();
