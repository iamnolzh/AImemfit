(() => {
  const out = new Set();
  const pushPath = p => { if (typeof p === 'string' && p.startsWith('/')) out.add(p); };

  // 通用路由检测：支持多种路由框架
  try { (window.$cloudwise && window.$cloudwise.routes || []).forEach(r => r && pushPath(r.path)); } catch (e) {}
  try { (window.router && window.router.options && window.router.options.routes || []).forEach(r => r && pushPath(r.path)); } catch (e) {}
  try { (window.__ROUTES__ || []).forEach(r => r && pushPath(r.path)); } catch (e) {}
  try { (window.__reactRoutes || []).forEach(r => r && pushPath(r.path)); } catch (e) {}

  // Vue Router 实例检测
  try {
    if (window.VueRouter) {
      const router = window.router || window.$router || window.Vue.prototype.$router;
      if (router && router.options && router.options.routes) {
        router.options.routes.forEach(r => r && pushPath(r.path));
      }
    }
  } catch (e) {}

  // React Router 检测
  try {
    if (window.ReactRouterDOM || window.ReactRouter) {
      // React Router 通常不暴露全局路由配置，依赖DOM链接检测
    }
  } catch (e) {}
  try { (window.__reactRoutes || []).forEach(r => r && pushPath(r.path)); } catch (e) {}

  Array.from(document.querySelectorAll('a[href]')).forEach(a => {
    const h = a.getAttribute('href');
    if (h && h.startsWith('/')) out.add(h.split('#')[0]);
  });

  return JSON.stringify({ routes: Array.from(out) });
})();
